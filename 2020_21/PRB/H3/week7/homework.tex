\documentclass{article}
\usepackage{homework-preamble}

\begin{document}
\title{Probability: Week 7 Solutions}
\author{Franz Miltz (UNN: S1971811)}
\date{10 November, 2020}
\maketitle


\section*{P7.1}


Let $X_1,X_2,...$ be as described in the questions. We find
\begin{align*}
  \E(X) & = \P(X_1^c)(\E(X)+1)                \\
        & +\P(X_1\cap X_2^c)(\E(X)+2)         \\
        & +\P(X_1\cap X_2\cap X_3^c)(\E(X)=3) \\
        & +3\P(X_1\cap X_2\cap X_3)
\end{align*}
With $\E(X)=s$ and $q=1-p$ we find
\begin{align}
  \label{eqs}
  s = q(s+1) + pq(s+2) + p^2q(s+3) +3p^3
\end{align}
because after any of the first three starts to the sequence the chances
are the same as they were in the beginning.
We can rewrite equation (\ref{eqs}) to find
\begin{align*}
  s & = qs + q + pqs + 2pq + p^2qs + 3p^2q + 3p^3 \\
    & = s(q+pq+p^2q)+q + 2pq + 3p^2q + 3p^3.      \\
\end{align*}
This lets us write $s$ in terms of $p$ and $q$:
\begin{align*}
  s & = \frac{q+2pq+3p^2q+3p^3}{1-q-pq-p^2q} =\frac{1+p+p^2}{p^3}.
\end{align*}
Thus the expected number of trials up to and including the first occurrence of
three consecutive successes is
\begin{align*}
  \E(X) = \frac{1+p+p^2}{p^3}.
\end{align*}


\section*{P7.2}


Observe that the the $i$th step $S_i=x_i-x_{i-1}$ for $i\in\N$ is either $-1$ or
$1$ with equal probability. Therefore we can define $S_i$ in terms of the
random variable $W_i\sim\Bern(1/2)$ as follows:
\begin{align*}
  S_i = 2W_i - 1.
\end{align*}
Notice that if $W_i=0$ then $S_i=-1$ and if $W_i=1$ then $S_i=1$. This is as
desired. Let us now consider the position at some point in time $t$:
\begin{align*}
  X_n = x_0 + \sum_{i=1}^n S_i = \sum_{i=1}^n \left(2W_i - 1\right).
\end{align*}
We can move the constants out of the sum to find
\begin{align*}
  X_n = 2\sum_{i=1}^n W_i - n.
\end{align*}
Since a binomial random variable with $n$ trials is, by definition, the
sum of $n$ Bernoulli variables, we can define $B_n\sim\Binom(n,1/2)$
and write
\begin{align*}
  X_n = 2B_n - n
\end{align*}
as required. This lets us find the expected value $\E(X_n)$
\begin{align*}
  \E(X_n) = \E(2B_n-n) = 2\E(B_n)-\E(n) = 2\left(\frac{n}{2}\right)-n = 0
\end{align*}
and the variance $\V(X_n)$
\begin{align*}
  \V(X_n) = \V(2B_n-n) = 4\V(B_n) = 4\left(\frac{n}{4}\right)=n.
\end{align*}
Therefore
\begin{align*}
  \sigma_{X_n} = \sqrt{\V(X_n)} = \sqrt{n}.
\end{align*}
For any sequence of $n$ steps, we have
\begin{align*}
  x_n = x_0 + a - b
\end{align*}
where $a+b=n$. Since $x_0=0$ we require $a=b$ for $x_n=0$. Using this,
we can write $a + a = 2a = n$ which is equivalent to $n$ being even.
Therefore $x_n=0$ cannot occur for odd $n$.\\
Observe that $X_{2n}=0$ if and only if $B_{2n}=n$. In the \emph{P2.2} we derived
that
\begin{align*}
  \P(B_{2n}=n) \approx \frac{1}{\sqrt{\pi n}}
\end{align*}
for large $n$. Since this is the same as what we are trying to approximate,
we can write
\begin{align*}
  \P(X_{2n}=0) \approx \frac{1}{\sqrt{\pi n}}
\end{align*}
as well.


\section*{P7.3}


Let $X_k$ be the number of steps before a random walk starting at a node
$k$ steps away from the desired target terminates. Then we find the following
expected values for $k\in[1,3]$ with $E(X_k) = s_k$ and $s_0=0$:
\begin{align}
  \label{s1}
  s_1 & = 1 + \frac{s_0}{2} + \frac{s_2}{2} = 1 + \frac{s_2}{2}, \\
  \label{s2}
  s_2 & = 1 + \frac{s_1}{2} + \frac{s_3}{2},                     \\
  \label{s3}
  s_3 & = 1 + s_2.
\end{align}
By inserting (\ref{s3}) into (\ref{s2}) we find
\begin{align*}
  s_2 = 3 + s_1.
\end{align*}
Using this in (\ref{s1}) gives $s_1=5$ and thus $s_2=8$ and $s_3=9$.
By using the fact that $\sigma_{X_n}\to\infty$ as $n\to\infty$, we find that
$\P(X_n)\to 0$ at the same time.


\section*{P7.4}


\begin{claim*}
  Consider a random walk on the integers in $[0,n]$ where on each move, one moves right with
  probability $p\not=1/2$ and left with probability $q=1-p$. The endpoints $0$ and $n$ are absorbing.
  Then the probability $s_k$ that a walk starting at $x_0=k$ is absorbed at $0$ is
  \begin{align*}
    s_k = \frac{\left(\frac{q}{p}\right)^k-\left(\frac{q}{p}\right)^n}{1-\left(\frac{q}{p}\right)^n}
  \end{align*}
\end{claim*}
\begin{proof}
  Firstly, observe that the desired probability can be described as follows:
  \begin{align*}
    s_{k} = ps_{k+1} + qs_{k-1}.
  \end{align*}
  We can rewrite this to find the homogenous difference equation
  \begin{align*}
    ps_{k+1} - s_k + qs_{k-1} = 0.
  \end{align*}
  This leads us to the characteristic equation
  \begin{align*}
    p\lambda^2 - \lambda + q = 0
  \end{align*}
  with the roots $\lambda_1 = q/p$ and $\lambda_2 = 1$.
  Since we have two distinct roots, the general solution is
  \begin{align*}
    s_k = a\lambda_1^k + b\lambda_2^k = a\left(\frac{q}{p}\right)^k + b.
  \end{align*}
  Through $s_0=1$ we find $b=1-a$. Using this and $s_n=0$, we get
  \begin{align*}
    0 = a\left(\frac{q}{p}\right)^k - a + 1.
  \end{align*}
  We can solve this for $a$ to find
  \begin{align*}
    a = \frac{1}{1-\left(\frac{p}{q}\right)^n}.
  \end{align*}
  Thus
  \begin{align*}
    s_k =\frac{\left(\frac{q}{p}\right)^k-1}{1-\left(\frac{p}{q}\right)^n}+1
    =\frac{\left(\frac{q}{p}\right)^k-\left(\frac{p}{q}\right)^n}{1-\left(\frac{p}{q}\right)^n}.
  \end{align*}
\end{proof}

\subsection*{Challenge}

Let $r=q/p$. Then
\begin{align*}
  L = \lim_{n\to\infty} s_k =
  \lim_{n\to\infty}\left(\frac{r^k-r^n}{1-r^n}\right).
\end{align*}
In the case $r<1$ we find
\begin{align*}
  L = \lim_{n\to\infty}\left(\frac{r^k-0}{1-0}\right) = r^k.
\end{align*}
In the case $r>1$ we can apply \emph{L'H\^opital's rule} as follows:
\begin{align*}
  L = \lim_{n\to\infty}\left(\frac{\frac{d}{dn}(r^k-r^n)}{\frac{d}{dn}(1-r^n)}\right)
  = \lim_{n\to\infty}\left(\frac{-\ln(r)r^n}{-\ln(r)r^n}\right)=1.
\end{align*}
Thus, in general,
\begin{align*}
  L = \begin{cases}
    r^k & \text{if }r<1 \\
    1   & \text{if }r>1
  \end{cases}.
\end{align*}
Thus, if we were to remove the upper bound $n$ and extend the walk to the entirety
of the non-negative integers, we would expect the probability of being
absorbed at $0$ to be $1$ if $r>1$, i.e. we are more likely to go left
than right, and to decrease the further we get a way from $0$ if $r<1$,
i.e. we're more likely to go right than left.
\end{document}