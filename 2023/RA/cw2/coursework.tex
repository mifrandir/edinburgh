\documentclass{article}
\usepackage{homework-preamble}

\title{Randomised Algorithms: Coursework 2}
\author{Franz Miltz}
\begin{document}
\maketitle

Let $G=\rr{V,E}$ be an undirected finite graph with maximum degree $\Delta$, let $\Omega\subseteq\mathcal P\rr{V}$
be the set of independent sets on $G$, and let $\e:\P\rr{V}\to \cc{0,1}^V$ be the bijection
between subsets of $V$ and corresponding binary encodings, i.e. $\e\rr{x}\rr{v}=1$ iff $v\in x$.
We abuse notation and write $x\rr{v}=\e\rr{x}\rr{v}$.

Now fix $\lambda\in\rr{0,\infty}$ and let $\pi:\mathcal P\rr{V}\to\bb{0,1}$ be the probability distribution defined by
\begin{align*}
  \pi\cc{x}=
  \begin{cases}
    \frac{\lambda^{\abs{x}}}{Z\rr{\lambda}} &\text{if }\forall \cc{v,w}\in E.\:x\rr{v}x\rr{w}=0 \\
    0 &\text{otherwise}
  \end{cases}
\end{align*}
where $Z\rr{\lambda}=\sum_{x\in\cc{0,1}^V} \lambda^{\abs{x}}$.

Let $\rr{X_t}_{t\geq 0}$ be the discrete time stochastic process associated with the Glauber dynamics
for $\pi$ and, for each $t\in T$, let $V_t$ be the random variable denoting the choice of
vertex $v\in V$ in the transition from $X_t$ to $X_{t+1}$. That is, for all $t\geq 0$, all $x,y\in\Omega$,
and each choice $v\in V$, we have the transition probability
\begin{align*}
  \prc{X_{t+1}=y}{X_t=x, V_t=v} =
  \begin{cases}
    \frac{\pi\cc{y}}{\pi\rr{\Omega\rr{x,v}}} &\text{if }y\in\Omega\rr{x,v} \\
    0 &\text{otherwise}
  \end{cases}
\end{align*}

\begin{claim*}[1]
  Let $\rr{Y_t}_{t\geq 0}$ be a discrete time stochastic process over $\Omega$ with the
  following transition rule from a given state $Y_t=x$ to a state $Y_{t+1}=y$:
  \begin{enumerate}
    \item An element $v\in V$ is chosen uniformly at random.
    \item For all $w\neq v$, $y\rr{w}=x\rr{w}$.
    \item If there is an $w\in N\rr{v}$ such that $x\rr{w}=1$ then $y\rr{v}=0$.
    \item Else, assign $y\rr{v}=1$ with probability $\lambda/\rr{1+\lambda}$ and $y\rr{v}=0$
      with probability $1/\rr{1+\lambda}$.
  \end{enumerate}
  For all $\lambda\in\rr{0,\infty}$, the processes $\rr{X_t}_{t\geq 0}$ and $\rr{Y_t}_{t\geq 0}$ are equivalent.
  \begin{proof}
    For all $t$, let $V'_t$ be the random variable denoting the choice of vertex $v\in V$ in the
    transition from $Y_t$ to $Y_{t+1}$.
    Let $t\in T$, $x,y\in\Omega$ and $x\ominus y=\rr{x\setminus y}\cup\rr{y\setminus x}$
    denote the symmetric difference.

    Consider the case $\abs{x\ominus y}>1$. We clearly have
    \begin{align*}
      \prc{Y_{t+1}=y}{Y_t=x, \abs{x\ominus y}>1} = \prc{X_{t+1}=y}{X_t=x, \abs{x\ominus y}>1} = 0
    \end{align*}
    as each update only affects at most one vertex.

    Consider the case $\vv{x\ominus y}=1$. We have to differentiate between the cases
    $x\subset y$ and $x\supset y$. Let $v\in V$ and assume $x\cup\cc{v}=y$. We find the probabilities
    \begin{align*}
      \prc{Y_{t+1}=y}{Y_t=x, V_t=v} = \frac{\lambda}{1+\lambda}.
    \end{align*}
    Moreover,
    \begin{align*}
      \prc{X_{t+1}=y}{X_t=x, V_t=v}
      = \frac{\pi\cc{y}}{\pi\rr{\Omega\rr{x,v}}}
      = \frac{\lambda^{\vv{y}}}{\lambda^{\vv{x}}+\lambda^{\vv{y}}}
      = \frac{\lambda\lambda^{\vv{x}}}{\lambda^{\vv{x}}\rr{1+\lambda}}
      = \frac{\lambda}{1+\lambda}
    \end{align*}
    and
    \begin{align*}
      \prc{X_{t+1}=y}{X_t=x, V_t\neq v} = 0
    \end{align*}
    Thus
    \begin{align*}
      \prc{X_{t+1}=y}{X_t=x} &= \sum_{v\in V} \pr{V_t=v}\prc{X_{t+1}=y}{X_t=x, V_t= v} \\
                             &= \frac{1}{\vv{V}} \frac{\lambda}{1+\lambda} \\
                             &= \sum_{v\in V} \pr{V'_t=v}\prc{Y_{t+1}=y}{Y_t=x, V'_t= v} \\
                             &=\prc{Y_{t+1}=y}{Y_t=x}
    \end{align*}
    Analogously, we assume $x=y\cup\cc{v}$. Then
    \begin{align*}
      \prc{Y_{t+1}=y}{Y_t=x, V_t=v} = \frac{1}{1+\lambda},
    \end{align*}
    and
    \begin{align*}
      \prc{X_{t+1}=y}{X_t=x, V_t=v}
      = \frac{\pi\cc{y}}{\pi\rr{\Omega\rr{x,v}}}
      = \frac{\lambda^{\vv{y}}}{\lambda^{\vv{x}}+\lambda^{\vv{y}}}
      = \frac{\lambda^{\vv{y}}}{\lambda^{\vv{y}}\rr{\lambda+1}}
      = \frac{1}{1+\lambda}.
    \end{align*}
    Thus
    \begin{align*}
      \prc{X_{t+1}=y}{X_t=x} &= \sum_{v\in V} \pr{V_t=v}\prc{X_{t+1}=y}{X_t=x, V_t= v} \\
                             &= \frac{1}{\vv{V}} \frac{1}{1+\lambda} \\
                             &= \sum_{v\in V} \pr{V'_t=v}\prc{Y_{t+1}=y}{Y_t=x, V'_t= v} \\
                             &=\prc{Y_{t+1}=y}{Y_t=x}
    \end{align*}

    We consider the remaining case $x=y$. We do this by differentiating three cases.
    Consider the case where the vertex selected already is in the independent set:
    \begin{align*}
      \prc{X_{t+1}=y}{X_t=x, V_t\in X_t}
      = \sum_{v\in x} \pr{V_t=v} \prc{X_{t+1}=y}{X_t=x, V_t=v}
      = \frac{1}{\vv{x}}\sum_{v\in x} \frac{\pi\cc{y}}{\pi\rr{\Omega\rr{x,v}}}.
    \end{align*}
    We then observe, for $v\in x$, $\Omega\rr{x,v}=\cc{x,x\setminus\cc{v}}$. Thus
    \begin{align*}
      \prc{X_{t+1}=y}{X_t=x, V_t\in X_t} &= \frac{1}{\vv{x}}\sum_{v\in x} \frac{\lambda^{\vv{x}}}{\lambda^{\vv{x}}+\lambda^{\vv{x}-1}} \\
                                         &= \frac{1}{\vv{x}}\sum_{v\in x} \frac{\lambda}{\lambda+1} \\
                                         &= \frac{\lambda}{1+\lambda}  \\
                                         &= \prc{Y_{t+1}=y}{Y_t=x, V'_t\in Y_t}
    \end{align*}
    where the probability for $Y_{t+1}$ follows as the condition in step 3 always fails and we require $y\rr{v}=1$.

    Next, we consider the case where the vertex selected is a neighbour of the independent set.
    We find
    \begin{align*}
      \prc{X_{t+1}=y}{X_t=x, V_t\in N\rr{X_t}} = 0 = \prc{Y_{t+1}=y}{Y_t=x, V'_t\in N\rr{Y_t}}.
    \end{align*}

    Finally, we have the case where the vertex selected is neither in the independent set
    nor a neighbour. Then
    \begin{align*}
      \prc{X_{t+1}=y}{X_t=x, V_t\not\in N\rr{X_t}\cup \cc{X_t}}
      &= \frac{1}{\vv{V}-\vv{N\rr{v}}-1}\sum_{v\in V\setminus N\rr{x}\setminus\cc{x}} \prc{X_{t+1}=y}{X_t=x, V_t=v} \\
      &= \frac{1}{\vv{V}-\vv{N\rr{v}}-1}\sum_{v\in V\setminus N\rr{x}\setminus\cc{x}} \frac{\pi\cc{x}}{\pi\rr{\Omega\rr{x,v}}}.
    \end{align*}
    We again note that $x\cup\cc{v}$ is an independent set so $\Omega\rr{x,v}=\cc{x,x\cup\cc{v}}$. So
    \begin{align*}
      \prc{X_{t+1}=y}{X_t=x, V_t\not\in N\rr{X_t}\cup \cc{X_t}}
      &= \frac{1}{\vv{V}-\vv{N\rr{v}}-1}\sum_{v\in V\setminus N\rr{x}\setminus\cc{x}} \frac{\lambda^{\vv{x}}}{\lambda^{\vv{x}}+\lambda^{\vv{x}+1}} \\
      &= \frac{\lambda}{1+\lambda} \\
      &= \prc{Y_{t+1}=y}{Y_t=x, V'_t\not\in N\rr{Y_t}\cup \cc{Y_t}}
    \end{align*}
    where the probability for $Y_{t+1}$ follows as the condition in step 3 always fails and we require $y\rr{v}=0$.

    We have shown equality of probabilities exhaustively for all cases. Thus $X_t$ and $Y_t$ are
    equivalent.
  \end{proof}
\end{claim*}


\begin{claim*}[2]
  $\pi$ satisfies the detailed balance condition for $\rr{X_t}$.
  I.e. for all $x,y\in\Omega$ and $t\geq 0$,
  \begin{align*}
    \pi\cc{x}\prc{X_{t+1}=y}{X_t=x}=\pi\cc{y}\prc{X_{t+1}=x}{X_t=y}.
  \end{align*}
  \begin{proof}
    For all $t\geq 0$ and $x,y\in\Omega$, write
    \begin{align*}
      P\rr{x,y}=\prc{X_{t+1}=y}{X_t=x}.
    \end{align*}
    Let $x,y\in\Omega$. If $x=y$ then the claim is immediate. If $\abs{x\ominus y}>1$ then
    \begin{align*}
      P\rr{x,y}=P\rr{y,x}=0.
    \end{align*}
    Finally, consider the remaining case $\abs{x\ominus y}=1$. Without loss of generality, assume $x=y\cup\cc{v}$. Then
    \begin{align*}
      \pi\cc{x}P\rr{x,y}
      &={\frac{\lambda^{\abs{x}}}{Z\rr{\lambda}}}{\frac{1}{\abs{V}\rr{1+\lambda}}} \\
      &={\frac{\lambda^{\abs{x}-1}}{Z\rr{\lambda}}}{\frac{\lambda}{\abs{V}\rr{1+\lambda}}} \\
      &={\frac{\lambda^{\abs{y}}}{Z\rr{\lambda}}}{\frac{\lambda}{\abs{V}\rr{1+\lambda}}} \\
      &=\pi\cc{y}P\rr{y,x}.
    \end{align*}
  \end{proof}
\end{claim*}

Let $\rr{Z_t}=\rr{X_t,Y_t}$ be coupled Markov chains that transition
based on the Glauber dynamics. In particular, define the update rule for $\rr{X_t,Y_t}$
from a state $\rr{x,y}$ to a state $\rr{x',y'}$:
\begin{enumerate}
  \item An element $v\in V$ is chosen uniformly at random.
  \item For all $w\neq v$, $x'\rr{w}=x\rr{w}$ and $y'\rr{w}=y\rr{w}$.
  \item Let $c=1$ with probability $\lambda/\rr{\lambda+1}$ and $c=0$ otherwise.
  \item If there is a $w\in N\rr{v}$ such that $x\rr{w}=1$ then $x'\rr{v}=0$.
  \item Else, assign $x'\rr{v}=c$.
  \item If there is a $w\in N\rr{v}$ such that $y\rr{w}=1$ then $y'\rr{v}=0$.
  \item Else, assign $y'\rr{v}=c$.
\end{enumerate}
It is straightforward to see that this is a valid coupling, i.e. $\rr{X_t}$ and $\rr{Y_t}$
follow the correct distribution locally. For each $t$, let $W_t$ be the random variable
corresponding to the vertex selected in the transition from $Z_t$ to $Z_{t+1}$.

Moreover, for independent sets $x,y\in\Omega$, define their distance by
\begin{align*}
  \rho\rr{x,y} = \sum_{v\in V} \abs{x\rr{v}-y\rr{v}}.
\end{align*}
We immediately note $\rho\rr{x,y}=\abs{x\ominus y}$.

\begin{claim*}[3a]
  \begin{align*}
    \prc{\rho\rr{X_{t+1},Y_{t+1}}=0}{X_t\ominus Y_t=\cc{W_t}}=1.
  \end{align*}
  \begin{proof}
    Let $v\in V$ and let $x,x',y,y'\in\Omega$ such that $x\ominus y=\cc{v}$ and such that
    \begin{align*}
      \prc{Z_{t+1}=\rr{x',y'}}{Z_t=\rr{x,y},W_t=v}>0.
    \end{align*}
    Note that, for all $w\neq v$, $x\rr{w}=y\rr{w}$. Thus we have $x'\rr{w}=y'\rr{w}$.
    Now consider $x'\rr{v}$ and $y'\rr{v}$. Observe that the checks in steps 4 and 6 will
    both fail as both $x$ and $y$ are independent sets. Thus, for some $c\in\cc{0,1}$,
    $x'\rr{v}=c=y'\rr{v}$. Now, for all $w\in V$, $x'\rr{w}=y'\rr{v}$, i.e. $\rho\rr{x',y'}=0$.
  \end{proof}
\end{claim*}

\begin{claim*}[3b]
  For all $v\in V$,
  \begin{align*}
    \prc{\rho\rr{X_{t+1},Y_{t+1}}=1}{X_t\ominus Y_t=\cc{v},W_t\not\in N\rr{v}\cup\cc{v}}=1.
  \end{align*}
  \begin{proof}
    Let $v,w\in V$ and let $x,x',y,y'\in\Omega$ such that $x\ominus y=\cc{v}$, $w\not\in N\rr{v}\cup\cc{v}$, and
    \begin{align*}
      \prc{Z_{t+1}=\rr{x',y'}}{Z_t=\rr{x,y},W_t=w}>0.
    \end{align*}
    Again, we need only consider $x'\rr{w}$ and $y'\rr{w}$. Clearly $x\rr{w}=y\rr{w}$, so
    we require $x'\rr{w}=y'\rr{w}$. For a contradiction, assume $x'\rr{w}\neq y'\rr{w}$. Without loss of generality
    assume $x'\rr{w}=0$. Then it must be the case that there is some $u\in N\rr{w}$ such that
    $x\rr{u}=1$. Fix this $u$. We note that in order to achieve $x\rr{w}\neq y\rr{w}$ we must
    have sampled $c=1$ and the check in 6 must have failed. I.e., for all $u'\in N\rr{w}$,
    $y\rr{u'}=0$. In particular, $x\rr{u}=1$ and $y\rr{u}=0$. This implies $x\rr{u}\neq y\rr{u}$
    and thus $u=v$. However, $u\in N\rr{w}$, so $v\in N\rr{w}$, and then $w\in N\rr{v}$.
    This contradicts the premise. We conclude $x'\rr{w}=y'\rr{w}$.
  \end{proof}
\end{claim*}

\begin{claim*}[3c]
  For all $v\in V$,
  \begin{align*}
    \prc{\rho\rr{X_{t+1},Y_{t+1}}=2}{X_t\ominus Y_t=\cc{v},W_t\in N\rr{v}}<1/2.
  \end{align*}
  \begin{proof}
    Let $v,w\in V$ and let $x,x',y,y'\in\Omega$ such that $x\ominus y=\cc{v}$,
    $w\in N\rr{v}$, and
    \begin{align*}
      \prc{Z_{t+1}=\rr{x',y'}}{Z_t=\rr{x,y},W_t=w}>0.
    \end{align*}
    Once more we consider $x'\rr{w}$ and $y'\rr{w}$ and note $\rho\rr{x', y'}=2$
    iff $x'\rr{w}\neq y'\rr{w}$.

    Consider the case $v\in x$ and $v\not\in y$. Then the check in step 4 of the update
    will succeed so $x'\rr{w}=0$. The case $y'\rr{w}=1$ occurs only if the check in step
    6 fails and we sample $c=1$. Noting that $c$ is sampled independently we have, for all $v\in V$,
    \begin{align*}
      &\prc{\rho\rr{X_{t+1},Y_{t+1}}=2}{X_t\neq Y_t, X_t=Y_t\cup\cc{v},W_t\in N\rr{v}}\\
      &= \frac{\lambda}{1+\lambda}\prc{\rr{\exists w\in N\rr{W_t}. \: Y_t\rr{w}=1}}{X_t\neq Y_t, X_t=Y_t\cup\cc{v},W_t\in N\rr{v}} \\
      &\leq \frac{\lambda}{1+\lambda}.
    \end{align*}
    In order to achieve the strict bound we argue that, for all $v\in V$, there exist values
    of $x,y\in\Omega$ and $w\in N\rr{v}$ with $x\neq y$ and $x=y\cup\cc{v}$ such that
    \begin{align*}
      \prc{\rr{\exists w\in N\rr{W_t}. \: Y_t\rr{w}=2}}{X_t=x,Y_t=y,W_t=w} = 0.
    \end{align*}
    Let $y=\emptyset$, $x=\cc{v}$, and $w\in N\rr{v}$. (Note if $N\rr{v}$ is non-empty by assumption.)
    Now
    \begin{align*}
      \prc{\rho\rr{X_{t+1},Y_{t+1}}=2}{X_t\neq Y_t, X_t=Y_t\cup\cc{v},W_t\in N\rr{v}} < \frac{\lambda}{1+\lambda}.
    \end{align*}
    By symmetry, we obtain the same result for the case $v\not\in x$ and $v\in y$:
    \begin{align*}
      \prc{\rho\rr{X_{t+1},Y_{t+1}}=2}{X_t\neq Y_t, X_t\cup\cc{v}=Y_t,W_t\in N\rr{v}} < \frac{\lambda}{1+\lambda}.
    \end{align*}
    Thus, in general,
    \begin{align*}
      \prc{\rho\rr{X_{t+1},Y_{t+1}}=2}{X_t\neq Y_t,W_t\in N\rr{v}} < \frac{\lambda}{1+\lambda}.
    \end{align*}
  \end{proof}
\end{claim*}

\end{document}
